fun.views.navbar=Backbone.View.extend({events:{"click #details-report-btn":"detailsReport",'click input[name="current_account"]':"setAccountContext"},initialize:function(options){fun.containers.navbar=this.$el,this.account=localStorage.getItem("username"),this.context=sessionStorage.getItem("context"),fun.omnibus.on("change:context",function(){this.renderContext()},this),fun.omnibus.on("change:system_admin",function(){this.renderContext()},this)},render:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.navbar));this.$el.html(template),this.$el.removeClass("hide").addClass("show"),fun.utils.loggedIn()?(console.log("Just enter the dungeon!"),this.renderDashboard()):(console.log("Out of the dungeon"),this.renderLanding())},renderContext:function(){"use strict";var account=localStorage.getItem("username"),context=sessionStorage.getItem("context");null!==context&&"System Admin"===context.trim()?(this.$("#nav-new-account").removeClass("hide").addClass("show"),this.$("#nav-new-resource").removeClass("hide").addClass("show"),this.$("#nav-new-gateway").removeClass("hide").addClass("show"),this.$("#nav-new-contact").removeClass("show").addClass("hide"),this.$("#nav-new-campaign").removeClass("show").addClass("hide"),this.$("#nav-new-org").removeClass("show").addClass("hide")):account!==context&&null!==context?(this.$("#nav-new-org").removeClass("show").addClass("hide"),this.$("#nav-new-team").removeClass("hide").addClass("show"),this.$("#nav-new-member").removeClass("hide").addClass("show")):(this.$("#nav-new-member").removeClass("show").addClass("hide"),this.$("#nav-new-team").removeClass("show").addClass("hide"),this.$("#nav-new-org").removeClass("hide").addClass("show"))},renderLanding:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.navLanding)),navLanding=this.$("#fun-nav-landing");navLanding.html(template)},renderDashboard:function(){"use strict";var template,navDashboard,account,context;account=localStorage.getItem("username"),context=sessionStorage.getItem("context"),template=_.template(fun.utils.getTemplate(fun.conf.templates.navDashboard))({account:account}),navDashboard=this.$("#fun-nav-dashboard"),navDashboard.html(template),null!==context&&"System Admin"===context.trim()?(this.$("#nav-new-account").removeClass("hide").addClass("show"),this.$("#nav-new-resource").removeClass("hide").addClass("show"),this.$("#nav-new-gateway").removeClass("hide").addClass("show"),this.$("#nav-new-contact").removeClass("show").addClass("hide"),this.$("#nav-new-campaign").removeClass("show").addClass("hide"),this.$("#nav-new-org").removeClass("show").addClass("hide")):account!==context&&null!==context?(this.$("#nav-new-org").removeClass("show").addClass("hide"),this.$("#nav-new-team").removeClass("hide").addClass("show"),this.$("#nav-new-member").removeClass("hide").addClass("show")):(this.$("#nav-new-member").removeClass("show").addClass("hide"),this.$("#nav-new-team").removeClass("show").addClass("hide"),this.$("#nav-new-org").removeClass("hide").addClass("show"))},renderAdmin:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.navAdmin)),navAdmin=this.$("#fun-nav-admin");navAdmin.html(template)},detailsReport:function(){console.log("navbar detail reports")},renderDropdown:function(){"use strict";var account,length,orgData,itemData,itemTemplate,vonCount=0;if(console.log("render dropdown"),account=JSON.parse(localStorage.getItem("profile")),account?this.orgs=account.orgs:this.orgs=[],this.accountList=this.$("#account-list-ul"),this.orgs&&(length=this.orgs.length),length>0)for(vonCount;length>vonCount;++vonCount)orgData={account:account.account,org:this.orgs[vonCount]},itemData=_.extend(orgData,{counter:vonCount+1}),itemTemplate=_.template(fun.utils.getTemplate(fun.conf.templates.accountListItem))(itemData),this.accountList.append(itemTemplate)},renderAccountDropdown:function(account){"use strict";var length,orgData,itemData,itemTemplate,vonCount=0,account=account;JSON.stringify(account);if(console.log("render account for ... ",account.get("account")),account?this.orgs=account.get("orgs"):this.orgs=[],this.accountList=this.$("#account-list-ul"),this.orgs&&(length=this.orgs.length),length>0)for(vonCount;length>vonCount;++vonCount)orgData={account:account.get("account"),org:this.orgs[vonCount]},itemData=_.extend(orgData,{counter:vonCount+1}),itemTemplate=_.template(fun.utils.getTemplate(fun.conf.templates.accountListItem))(itemData),this.accountList.append(itemTemplate)},setAccountContext:function(event){"use strict";$('input[name="current_account"]:checked').each(function(){var idVal=$(this).attr("id"),label=$("label[for='"+idVal+"']").text();"current_account_admin"===idVal&&("undefined"!=typeof Storage&&sessionStorage.setItem("is_admin",!0),fun.omnibus.trigger("change:system_admin")),"undefined"!=typeof Storage&&sessionStorage.setItem("context",label)}),fun.omnibus.trigger("change:context")}}),fun.views.subheader=Backbone.View.extend({events:{"click #call-btn":"call"},initialize:function(options){fun.containers.subheader=this.$el,this.account=localStorage.getItem("username"),this.context=sessionStorage.getItem("context"),fun.omnibus.on("change:context",function(){this.renderHeadNav()},this)},render:function(header){"use strict";var data,template;header?this.header=header:this.header="nonsense",data={header:this.header},template=_.template(fun.utils.getTemplate(fun.conf.templates.subheader))(data),this.$el.html(template),this.$el.removeClass("hide").addClass("show")},renderHeadNav:function(){"use strict";var template,headNav,account,context;template=_.template(fun.utils.getTemplate(fun.conf.templates.headNav)),headNav=this.$("#fun-head-nav"),headNav.html(template),account=localStorage.getItem("username"),context=sessionStorage.getItem("context"),console.log(fun.utils.format("username: %s, context: %s",account,context)),account!==context&&"undefined"!=typeof context&&null!==context?(console.log("ORG context"),this.$("#head-nav-phone").removeClass("show").addClass("hide"),this.$("#head-nav-members").removeClass("hide").addClass("show"),this.$("#head-nav-teams").removeClass("hide").addClass("show"),this.$("#head-nav-contacts").removeClass("show").addClass("hide"),this.$("#head-nav-companies").removeClass("show").addClass("hide"),this.$("#head-nav-gateways").removeClass("show").addClass("hide"),this.$("#head-nav-cubes").removeClass("show").addClass("hide"),this.$("#head-nav-activity").removeClass("hide").addClass("show"),this.$("#head-nav-recordings").removeClass("show").addClass("hide"),this.$("#head-nav-accounts").removeClass("show").addClass("hide")):(console.log("User account"),this.$("#head-nav-phone").removeClass("hide").addClass("show"),this.$("#head-nav-members").removeClass("show").addClass("hide"),this.$("#head-nav-resources").removeClass("show").addClass("hide"),this.$("#head-nav-accounts").removeClass("show").addClass("hide"),this.$("#head-nav-gateways").removeClass("show").addClass("hide"),this.$("#head-nav-contacts").removeClass("hide").addClass("show"),this.$("#head-nav-teams").removeClass("show").addClass("hide"),this.$("#head-nav-activity").removeClass("show").addClass("hide")),"undefined"!==context&&null!==context&&"System Admin"===context.trim()&&(console.log("System Admin and stuff"),this.$("#head-nav-phone").removeClass("show").addClass("hide"),this.$("#head-nav-teams").removeClass("show").addClass("hide"),this.$("#head-nav-members").removeClass("show").addClass("hide"),this.$("#head-nav-gateways").removeClass("hide").addClass("show"),this.$("#head-nav-recordings").removeClass("show").addClass("hide"),this.$("#head-nav-campaigns").removeClass("show").addClass("hide"),this.$("#head-nav-resources").removeClass("hide").addClass("show"),this.$("#head-nav-accounts").removeClass("hide").addClass("show"))},renderHeadNavAdmin:function(){"use strict"},renderHeadNavCampaigns:function(){"use strict";var template,headNav;template=_.template(fun.utils.getTemplate(fun.conf.templates.headNavCampaigns)),headNav=this.$("#fun-head-nav"),headNav.html(template)},renderHeadNavReports:function(){"use strict";var template,headNav;template=_.template(fun.utils.getTemplate(fun.conf.templates.headNavReports)),headNav=this.$("#fun-head-nav"),headNav.html(template)},call:function(event){"use strict";event.preventDefault(),console.log("call some fucking one")}}),fun.views.landing=Backbone.View.extend({events:{"click #landing-signup-btn":"signup"},initialize:function(options){fun.containers.landing=this.$el},render:function(){"use strict";var template;this.$el.html()||(template=_.template(fun.utils.getTemplate(fun.conf.templates.landing)),this.$el.html(template),this.signupError=this.$("#landing-alert"),this.account=this.$("#landing_username"),this.newAccount=this.account,this.email=this.$("#landing_email"),this.password=this.$("#landing_password")),this.$el.removeClass("hide").addClass("show")},signup:function(event){"use strict";var signupError,account,password,email,view,rules,validationRules,callbacks,validForm;event.preventDefault(),signupError=this.signupError,account=this.account.val(),password=this.password.val(),email=this.email.val(),view=this,rules={rules:{landing_username:{minlength:2,required:!0},landing_email:{required:!0,email:!0},landing_password:{minlength:6,required:!0}}},validationRules=$.extend(rules,fun.utils.validationRules),$("#langing-signup-form").validate(validationRules),callbacks={success:function(){view.$("#landing_username").val(""),view.$("#landing_email").val(""),view.$("#landing_password").val(""),signupError.hide(),fun.utils.login(account,password,{success:function(xhr,status){fun.utils.redirect(fun.conf.hash.dashboard)},error:function(xhr,status,error){switch(xhr.status){case 403:var message=fun.utils.translate("usernameOrPasswordError");signupError.find("p").html(message),signupError.removeClass("hide").addClass("show");break;case 200:"undefined"!=typeof Storage&&localStorage.setItem("username",account),fun.utils.redirect(fun.conf.hash.login);break;default:console.log("the monkey is down")}}})},error:function(model,error){signupError.removeClass("hide").addClass("show"),-1!=error.responseText.indexOf("account")?signupError.find("p").html("Username is already taken."):-1!=error.responseText.indexOf("email")?signupError.find("p").html("Email is invalid or already taken."):signupError.find("p").html("what daa!?")}},validForm=$("#langing-signup-form").valid(),validForm&&(this.model=new fun.models.Account,this.model.save({account:account,password:password,email:email},callbacks))}}),fun.views.features=Backbone.View.extend({events:{},initialize:function(options){fun.containers.features=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.features));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")}}),fun.views.enterprise=Backbone.View.extend({events:{},initialize:function(options){fun.containers.enterprise=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.enterprise));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")}}),fun.views.pricing=Backbone.View.extend({events:{},initialize:function(options){fun.containers.pricing=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.pricing));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")}}),fun.views.terms=Backbone.View.extend({events:{},initialize:function(options){fun.containers.terms=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.terms));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")}}),fun.views.privacy=Backbone.View.extend({events:{},initialize:function(options){fun.containers.privacy=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.privacy));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")}}),fun.views.security=Backbone.View.extend({events:{},initialize:function(options){fun.containers.security=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.security));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")}}),fun.views.status=Backbone.View.extend({events:{},initialize:function(options){fun.containers.status=this.$el},render:function(){console.log("render status view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.status));this.$el.html(template),this.$el.removeClass("hide").addClass("show")}}),fun.views.help=Backbone.View.extend({events:{"click #help-query":"sendTask","click #close-help":"closeHelp"},initialize:function(options){fun.containers.help=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.help));this.$el.html(template),this.description=this.$("#help_description"),this.firstName=this.$("#help_firstname"),this.lastName=this.$("#help_lastname"),this.email=this.$("#help_email")}this.$el.removeClass("hide").addClass("show")},sendTask:function(event){"use strict";var idVal,description,firstName,lastName,email,resource,task,taskPayload;description=this.description.val(),firstName=this.firstName.val(),lastName=this.lastName.val(),email=this.email.val(),event.preventDefault(),$('input[name="current_resource"]:checked').each(function(){idVal=$(this).attr("id"),resource=$("label[for='"+idVal+"']").text()}),taskPayload={title:"On site help alert",label:resource,first_name:firstName,last_name:lastName,email:email,description:description},task=new fun.models.Task(taskPayload),task.save(),this.$("#help_description").val(""),this.$("#help_firstname").val(""),this.$("#help_lastname").val(""),this.$("#help_email").val("")},closeHelp:function(event){"use strict";event.preventDefault(),$("#fun-help").hide().removeClass("show").addClass("hide")}}),fun.views.signup=Backbone.View.extend({events:{"click #login-btn":"login","click #signup-btn":"signup"},initialize:function(options){fun.containers.signup=this.$el},render:function(){"use strict";var template;this.$el.html()||(template=_.template(fun.utils.getTemplate(fun.conf.templates.signup)),this.$el.html(template),this.signupError=this.$("#signup-alert"),this.account=this.$("#signup_username"),this.newAccount=this.account,this.email=this.$("#signup_email"),this.password=this.$("#signup_password"),this.confirmPassword=this.$("#confirm_password")),this.$el.removeClass("hide").addClass("show")},login:function(){window.location=fun.conf.hash.login},signup:function(event){"use strict";var signupError,account,password,confirmPassword,email,view,rules,validationRules,callbacks,validForm;event.preventDefault(),signupError=this.signupError,account=this.account.val(),password=this.password.val(),confirmPassword=this.confirmPassword.val(),email=this.email.val(),view=this,rules={rules:{signup_username:{minlength:2,required:!0},signup_email:{required:!0,email:!0},signup_password:{minlength:6,required:!0},confirm_password:{required:!1,minlength:6,equalTo:"#signup_password"}}},validationRules=$.extend(rules,fun.utils.validationRules),$("#signup-form").validate(validationRules),callbacks={success:function(){view.$("#signup_username").val(""),view.$("#signup_email").val(""),view.$("#signup_password").val(""),view.$("#confirm_password").val(""),signupError.hide(),fun.utils.login(account,password,{success:function(xhr,status){fun.utils.redirect(fun.conf.hash.dashboard)},error:function(xhr,status,error){switch(xhr.status){case 403:var message=fun.utils.translate("usernameOrPasswordError");signupError.find("p").html(message),signupError.removeClass("hide").addClass("show");break;case 200:"undefined"!=typeof Storage&&localStorage.setItem("username",account),fun.utils.redirect(fun.conf.hash.login);break;default:console.log("the monkey is down")}}})},error:function(model,error){signupError.removeClass("hide").addClass("show"),-1!=error.responseText.indexOf("account")?signupError.find("p").html("Username is already taken."):-1!=error.responseText.indexOf("email")?signupError.find("p").html("Email is invalid or already taken."):signupError.find("p").html("what daa!?")}},validForm=$("#signup-form").valid(),validForm&&(this.model=new fun.models.Account,this.model.save({account:account,password:password,email:email},callbacks))}}),fun.views.login=Backbone.View.extend({events:{"click #login-btn":"login","click #signup-btn":"signup"},initialize:function(options){fun.containers.login=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.login));this.$el.html(template),this.loginError=this.$("#signin-alert"),this.username=this.$("#username"),this.password=this.$("#password")}this.$el.removeClass("hide").addClass("show")},signup:function(){window.location=fun.conf.hash.signup},login:function(event){event.preventDefault();var loginError=this.loginError,username=this.username.val(),password=this.password.val(),view=this,loginSuccess=function(view,loginError){view.$("#username").val(""),view.$("#password").val(""),loginError.removeClass("show").addClass("hide"),fun.utils.redirect(fun.conf.hash.dashboard)};fun.utils.login(username,password,{success:function(jqXHR,textStatus){loginSuccess(view,loginError)},error:function(jqXHR,textStatus,errorThrown){switch(jqXHR.status){case 403:var message=fun.utils.translate("usernameOrPasswordError");loginError.find("p").html(message),loginError.removeClass("hide").addClass("show");break;case 200:"undefined"!=typeof Storage&&localStorage.setItem("username",username),loginSuccess(view,loginError);break;default:console.log("the monkey is down")}}})}}),fun.views.dashboard=Backbone.View.extend({events:{"click #today-btn":"today","click #this-week-btn":"thisWeek","click #this-month-btn":"thisMonth","click #this-year-btn":"thisYear"},initialize:function(options){"use strict";fun.containers.dashboard=this.$el,fun.omnibus.on("change:system_admin",function(){this.renderBoo()},this)},render:function(account,summary,billing){"use strict";var template;"undefined"==typeof account?this.account=localStorage.getItem("username"):this.account=account,template=_.template(fun.utils.getTemplate(fun.conf.templates.dashboard))({account:this.account}),this.$el.html(template),this.$el.removeClass("hide").addClass("show"),this.renderTodaySummary(this.account,summary,billing),this.renderTodayActivityChart(),this.renderRecordType()},renderBoo:function(){"use strict";console.log("corporate warfare")},renderTodaySummary:function(summary,billing){"use strict";var data,template,todaySummary;summary&&(this.summary=summary),billing&&(this.billing=billing),data=summary&&billing?_.extend(this.summary.toJSON(),this.billing.toJSON()):{minutes:0,records:0,billing:0,record_avg:0},template=_.template(fun.utils.getTemplate(fun.conf.templates.todaySummary))(data),todaySummary=this.$("#fun-today-summary"),todaySummary.html(template)},renderTodayActivityChart:function(summary){"use strict";var template,todayActivityChart,data=[],minutes=[],records=[];summary&&(this.summary=summary,this.minutes=summary.get("minutes"),this.records=summary.get("records")),minutes=_.pairs(this.minutes),records=_.pairs(this.records),data.push({data:minutes,label:"Minutes"}),data.push({data:records,label:"Records",points:{show:!1},lines:{lineWidth:2,fill:!1}}),template=_.template(fun.utils.getTemplate(fun.conf.templates.todayActivityChart))(data),todayActivityChart=this.$("#fun-today-activity-chart"),todayActivityChart.html(template),Charts.line("#line-chart",data)},renderLatestRecords:function(collection){"use strict";var template,latestRecords;void 0!==collection&&null!==collection?this.collection=collection:this.collection=0,template=_.template(fun.utils.getTemplate(fun.conf.templates.latestRecords)),latestRecords=this.$("#fun-latest-records"),latestRecords.html(template),this.tbody=this.$("#records-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderRows()},renderRecordType:function(){"use strict";var data,series,recordType,template,i=0;for(data=[],series=Math.floor(6*Math.random())+3,i;series>i;i++)data[i]={label:"Series"+(i+1),data:Math.floor(100*Math.random())+1};template=_.template(fun.utils.getTemplate(fun.conf.templates.recordType))(data),recordType=this.$("#fun-record-type"),recordType.html(template),$.plot("#pie-chart",data,{series:{pie:{show:!0}}})},renderRows:function(){"use strict";var length,rows,data,template,vonCount=0;if(length=this.collection.length,void 0!==length||null!==length&&length>0){rows=this.tbody.html("");var datfuq=this.collection.at(vonCount).toJSON();for(vonCount;7>vonCount;++vonCount)data=_.extend(datfuq,{counter:vonCount}),template=_.template(fun.utils.getTemplate(fun.conf.templates.recordRow))(data),rows.append(template)}else this.noRecords()},noRecords:function(){"use strict";var template,noRecords;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noRecords=this.$("#no-records"),noRecords.html(template)},today:function(event){"use strict";console.log("today event")},thisWeek:function(event){"use strict";console.log("this week event")},thisMonth:function(event){"use strict";console.log("this month event")},thisYear:function(event){"use strict";console.log("this year event")}}),fun.views.campaigns=Backbone.View.extend({events:{"click #create-campaign-btn":"createCampaign"},initialize:function(options){fun.containers.campaigns=this.$el},render:function(){"use strict";var account,template;console.log("render campaigns view"),account=localStorage.getItem("username"),this.$el.html()||(template=_.template(fun.utils.getTemplate(fun.conf.templates.campaigns))({account:account}),this.$el.html(template),this.campaignName=this.$("#campaign_name"),this.campaignDescription=this.$("#campaign_description"),this.account=account),this.$el.removeClass("hide").addClass("show")},renderCampaignsList:function(campaigns){"use strict";var template,allCampaigns;console.log("render campaigns list"),campaigns&&(this.campaigns=campaigns),template=_.template(fun.utils.getTemplate(fun.conf.templates.allCampaigns)),allCampaigns=this.$("#all-campaigns-tab"),allCampaigns.html(template),this.tbody=this.$("#campaigns-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderCampaignRows()},renderCampaignRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.campaigns.length,console.log("campaigns length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.campaigns.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignRow))(data),rows.append(template);else this.noCampaigns()},noCampaigns:function(){"use strict";var template,noCampaigns;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noCampaigns=this.$("#no-campaigns"),noCampaigns.html(template)},renderActiveCampaignsList:function(campaigns){"use strict";var template,activeCampaigns;console.log("render active campaigns list"),campaigns&&(this.activeCampaigns=campaigns),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignsActiveTab)),activeCampaigns=this.$("#active-campaigns-tab"),activeCampaigns.html(template),this.tbody=this.$("#active-campaigns-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderActiveCampaignRows()},renderActiveCampaignRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.activeCampaigns.length,console.log("active campaigns length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.activeCampaigns.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignRow))(data),rows.append(template);else this.noActiveCampaigns()},noActiveCampaigns:function(){"use strict";var template,noActiveCampaigns;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noActiveCampaigns=this.$("#no-active-campaigns"),noActiveCampaigns.html(template)},renderPausedCampaignsList:function(campaigns){"use strict";var template,pausedCampaigns;console.log("render paused campaigns list"),campaigns&&(this.pausedCampaigns=campaigns),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignsPausedTab)),pausedCampaigns=this.$("#paused-campaigns-tab"),pausedCampaigns.html(template),this.tbody=this.$("#paused-campaigns-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderPausedCampaignRows()},renderPausedCampaignRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.pausedCampaigns.length,console.log("paused campaigns length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.pausedCampaigns.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignRow))(data),rows.append(template);else this.noPausedCampaigns()},noPausedCampaigns:function(){"use strict";var template,noPausedCampaigns;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noPausedCampaigns=this.$("#no-paused-campaigns"),noPausedCampaigns.html(template)},renderInboundCampaignsList:function(campaigns){"use strict";var template,inboundCampaigns;console.log("render inbound campaigns list"),campaigns&&(this.inboundCampaigns=campaigns),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignsInboundTab)),inboundCampaigns=this.$("#inbound-campaigns-tab"),inboundCampaigns.html(template),this.tbody=this.$("#inbound-campaigns-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderInboundCampaignRows()},renderInboundCampaignRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.inboundCampaigns.length,console.log("inbound campaigns length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.inboundCampaigns.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignRow))(data),rows.append(template);else this.noInboundCampaigns()},noInboundCampaigns:function(){"use strict";var template,noInboundCampaigns;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noInboundCampaigns=this.$("#no-inbound-campaigns"),noInboundCampaigns.html(template)},renderOutboundCampaignsList:function(campaigns){"use strict";var template,outboundCampaigns;console.log("render outbound campaigns list"),campaigns&&(this.outboundCampaigns=campaigns),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignsOutboundTab)),outboundCampaigns=this.$("#outbound-campaigns-tab"),outboundCampaigns.html(template),this.tbody=this.$("#outbound-campaigns-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderOutboundCampaignRows()},renderOutboundCampaignRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.outboundCampaigns.length,console.log("outbound campaigns length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.outboundCampaigns.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.campaignRow))(data),rows.append(template);else this.noOutboundCampaigns()},noOutboundCampaigns:function(){"use strict";var template,noOutboundCampaigns;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noOutboundCampaigns=this.$("#no-outbound-campaigns"),noOutboundCampaigns.html(template)},createCampaign:function(event){"use strict";event.preventDefault();var account,campaign,campaignName,campaignDescription,campaignPayload,view=this;console.log("create campaign event"),this.campaignName=this.$("#campaign_name"),this.campaignDescription=this.$("#campaign_description"),account=this.account,campaignName=this.campaignName.val(),campaignDescription=this.campaignDescription.val(),console.log(account,campaignName,campaignDescription),campaignPayload={account:account,name:campaignName,description:campaignDescription},void 0!=account&void 0!=campaignName&&(campaign=new fun.models.Campaign(campaignPayload),campaign.save()),view.$("#campaign_name").val(""),view.$("#campaign_description").val("")}}),fun.views.orgs=Backbone.View.extend({events:{"click #new-org-btn":"newORG"},initialize:function(options){fun.containers.orgs=this.$el},render:function(){if(console.log("render orgs view"),!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.orgs));this.$el.html(template),this.orgName=this.$("#organization_name"),this.orgEmail=this.$("#billing_email")}this.$el.removeClass("hide").addClass("show")},newORG:function(event){event.preventDefault(),console.log("new org event");var view=this,orgName=this.orgName.val(),orgEmail=this.orgEmail.val(),org=new fun.models.Org({account:orgName,email:orgEmail});org.save(),view.$("#organization_name").val(""),view.$("#billing_email").val(""),window.location=fun.conf.hash.settings}}),fun.views.profile=Backbone.View.extend({events:{"click #act_1":"oneDay","click #act_2":"threeDays","click #act_3":"oneWeek","click #act_4":"oneMonth"},initialize:function(options){fun.containers.profile=this.$el},render:function(){console.log("render profile view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.profile));this.$el.html(template),this.$el.removeClass("hide").addClass("show");var startDate=new Date(2013,6,25),cal=(new Date(2013,6,1).getTime()/1e3,new CalHeatMap);cal.init({domain:"day",subDomain:"hour",rowLimit:1,cellSize:10,domainGutter:0,verticalOrientation:!0,label:{position:"left",offset:{x:20,y:12},width:110},start:startDate,range:10,itemName:"visit",legend:[5,10,15,20,25,30],legendHorizontalPosition:"right",legendColors:{empty:"#ededed",min:"#40ffd8",max:"#f20013"}})},oneDay:function(event){console.log("one day event")},threeDays:function(event){console.log("three days event")},oneWeek:function(event){console.log("one week event")},oneMonth:function(event){console.log("one month event")}}),fun.views.members=Backbone.View.extend({events:{"click #new-member-btn":"addMember"},initialize:function(options){fun.containers.members=this.$el,this.account=localStorage.getItem("username")},render:function(org){"use strict";var data,context,template;console.log("render members view"),context=sessionStorage.getItem("context"),org&&(this.members=org.get("members")),data={org:context,name:!1,description:!1,email:"example@example.com",location:"Mars",uri:"http://iofun.io"},template=_.template(fun.utils.getTemplate(fun.conf.templates.members))(data),this.$el.html(template),this.membersList=this.$("#members-list"),this.$el.removeClass("hide").addClass("show"),this.renderMemberRows()},renderMemberRows:function(){"use strict";var length,memberData,itemData,itemTemplate,i=0;if(length=this.members.length,length>0)for(i;length>i;++i)memberData={member:this.members[i]},itemData=_.extend(memberData,{i:i+1}),itemTemplate=_.template(fun.utils.getTemplate(fun.conf.templates.memberRow))(itemData),this.membersList.append(itemTemplate)},addMember:function(){console.log("new member event")}}),fun.views.teams=Backbone.View.extend({events:{"click #new-team-btn":"addTeam"},initialize:function(options){fun.containers.teams=this.$el,this.account=localStorage.getItem("username")},render:function(org){"use strict";var data,context,template;console.log("render teams view"),context=sessionStorage.getItem("context"),org&&(this.teams=org.get("teams")),data={org:context,name:!1,description:!1,email:"example@example.com",location:"Mars",uri:"http://iofun.io"},template=_.template(fun.utils.getTemplate(fun.conf.templates.teams))(data),this.$el.html(template),this.teamsList=this.$("#teams-list"),this.$el.removeClass("hide").addClass("show"),this.renderTeamRows()},renderTeamRows:function(){"use strict";console.log("render team rows");var length,teamData,itemData,itemTemplate,i=0;
if(length=10,length>0)for(i;length>i;++i)teamData=this.teams[i],itemData=_.extend(teamData,{i:i+1}),(i+1)%2!==0&&(this.innerDiv=document.createElement("div"),this.innerDiv.className="row"),itemTemplate=_.template(fun.utils.getTemplate(fun.conf.templates.teamRow))(itemData),$(itemTemplate).appendTo(this.innerDiv),(i+1)%2===0&&this.teamsList.append(this.innerDiv)},addTeam:function(){console.log("new team event")}}),fun.views.activity=Backbone.View.extend({events:{},initialize:function(options){fun.containers.activity=this.$el},render:function(){console.log("render activity view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.activity));this.$el.html(template),this.$el.removeClass("hide").addClass("show")}}),fun.views.phone=Backbone.View.extend({events:{"click #btn-call":"sipInvite","click #btn-hangup":"sipBye","click #btn-message":"sipMessage","click #digit-0":"digitZero","click #digit-1":"digitOne","click #digit-2":"digitTwo","click #digit-3":"digitThree","click #digit-4":"digitFour","click #digit-5":"digitFive","click #digit-6":"digitSix","click #digit-7":"digitSeven","click #digit-8":"digitEight","click #digit-9":"digitNine"},initialize:function(options){fun.containers.phone=this.$el},render:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.phone)),configuration={uri:"sip:godstybba@sip.iofun.io",password:"zafary",wsServers:"ws://sip.iofun.io:10080",displayName:"godstybba",authorizationUser:"godstybba",register:!0,registerExpires:900,stunServers:["coturn.iofun.io:3478"],turnServers:{server:"turn:coturn.iofun.io:3478",username:"godstybba",password:"zafary"}},userAgent=new SIP.UA(configuration);this.userAgent=userAgent,this.$el.html(template),this.$el.removeClass("hide").addClass("show");var options={media:{constraints:{audio:!0,video:!1},render:{remote:document.getElementById("remoteVideo"),local:document.getElementById("localVideo")}}};this.options=options,this.renderDialBox()},renderDialBox:function(){console.log("render dialpad box");var template=_.template(fun.utils.getTemplate(fun.conf.templates.dialpad)),dialpad=this.$("#fun-dialpad");dialpad.html(template)},sipInvite:function(event){"use strict";var userAgent,options;userAgent=this.userAgent,options=this.options,event.preventDefault(),console.log("sip invite"),this.session=userAgent.invite("sip:500@sip.iofun.io",options)},sipBye:function(event){"use strict";var session=this.session;event.preventDefault(),session.bye(),console.log("Sending SIP BYE Method")},sipMessage:function(event){"use strict";event.preventDefault(),console.log("Sending SIP MESSAGE Method")},digitZero:function(event){"use strict";event.preventDefault(),console.log("digit zero")},digitOne:function(event){"use strict";event.preventDefault(),console.log("digit one")},digitTwo:function(event){"use strict";event.preventDefault(),console.log("digit two")},digitFive:function(event){"use strict";event.preventDefault(),console.log("digit five")}}),fun.views.gateways=Backbone.View.extend({events:{},initialize:function(options){fun.containers.gateways=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.gateways));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")},renderAllGatewaysList:function(gateways){"use strict";var template,allGateways;console.log("render all gateways list"),gateways&&(this.gateways=gateways),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewaysAllTab)),allGateways=this.$("#all-gateways-tab"),allGateways.html(template),this.tbody=this.$("#all-gateways-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderAllGatewaysRows()},renderAllGatewaysRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.gateways.length,console.log("all gateways length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.gateways.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewayRow))(data),rows.append(template);else this.noAllGateways()},noAllGateways:function(){"use strict";var template,noAllGateways;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noAllGateways=this.$("#no-all-gateways"),noAllGateways.html(template)},renderActiveGatewaysList:function(gateways){"use strict";var template,activeGateways;console.log("render active gateways list"),gateways&&(this.gateways=gateways),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewaysActiveTab)),activeGateways=this.$("#active-gateways-tab"),activeGateways.html(template),this.tbody=this.$("#active-gateways-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderActiveGatewaysRows()},renderActiveGatewaysRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.gateways.length,console.log("active gateways length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.gateways.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewayRow))(data),rows.append(template);else this.noActiveGateways()},noActiveGateways:function(){"use strict";var template,noActiveGateways;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noActiveGateways=this.$("#no-active-gateways"),noActiveGateways.html(template)},renderMonitoredGatewaysList:function(gateways){"use strict";var template,monitoredGateways;console.log("render monitored gateways list"),gateways&&(this.gateways=gateways),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewaysMonitoredTab)),monitoredGateways=this.$("#monitored-gateways-tab"),monitoredGateways.html(template),this.tbody=this.$("#monitored-gateways-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderMonitoredGatewaysRows()},renderMonitoredGatewaysRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.gateways.length,console.log("monitored gateways length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.gateways.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewayRow))(data),rows.append(template);else this.noMonitoredGateways()},noMonitoredGateways:function(){"use strict";var template,noMonitoredGateways;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noMonitoredGateways=this.$("#no-monitored-gateways"),noMonitoredGateways.html(template)},renderInboundGatewaysList:function(gateways){"use strict";var template,inboundGateways;console.log("render inbound gateways list"),gateways&&(this.gateways=gateways),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewaysInboundTab)),inboundGateways=this.$("#inbound-gateways-tab"),inboundGateways.html(template),this.tbody=this.$("#inbound-gateways-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderInboundGatewaysRows()},renderInboundGatewaysRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.gateways.length,console.log("inbound gateways length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.gateways.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewayRow))(data),rows.append(template);else this.noInboundGateways()},noInboundGateways:function(){"use strict";var template,noInboundGateways;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noInboundGateways=this.$("#no-inbound-gateways"),noInboundGateways.html(template)},renderOutboundGatewaysList:function(gateways){"use strict";var template,outboundGateways;console.log("render outbound gateways list"),gateways&&(this.gateways=gateways),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewaysOutboundTab)),outboundGateways=this.$("#outbound-gateways-tab"),outboundGateways.html(template),this.tbody=this.$("#outbound-gateways-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderOutboundGatewaysRows()},renderOutboundGatewaysRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.gateways.length,console.log("outbound gateways length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.gateways.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.gatewayRow))(data),rows.append(template);else this.noOutboundboundGateways()},noOutboundboundGateways:function(){"use strict";var template,noOutboundboundGateways;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noOutboundboundGateways=this.$("#no-outbound-gateways"),noOutboundboundGateways.html(template)}}),fun.views.accounts=Backbone.View.extend({events:{"click #create-account-btn":"createAccount"},initialize:function(options){fun.containers.accounts=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.accounts));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")},renderAllAccountsList:function(accounts){"use strict";var template,allAccounts;console.log("render all accounts list"),accounts&&(this.accounts=accounts),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountsAllTab)),allAccounts=this.$("#all-accounts-tab"),allAccounts.html(template),this.tbody=this.$("#all-accounts-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderAllAccountsRows()},renderAllAccountsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.accounts.length,console.log("all accounts length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.accounts.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountRow))(data),rows.append(template);else this.noAllAccounts()},noAllAccounts:function(){"use strict";var template,noAllAccounts;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noAllAccounts=this.$("#no-all-accounts"),noAllAccounts.html(template)},renderActiveAccountsList:function(accounts){"use strict";var template,activeAccounts;console.log("render active accounts list"),accounts&&(this.accounts=accounts),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountsActiveTab)),activeAccounts=this.$("#active-accounts-tab"),activeAccounts.html(template),this.tbody=this.$("#active-accounts-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderActiveAccountsRows()},renderActiveAccountsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.accounts.length,console.log("all active length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.accounts.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountRow))(data),rows.append(template);else this.noActiveAccounts()},noActiveAccounts:function(){"use strict";var template,noActiveAccounts;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noActiveAccounts=this.$("#no-active-accounts"),noActiveAccounts.html(template)},renderUsersAccountsList:function(accounts){"use strict";var template,usersAccounts;console.log("render users accounts list"),accounts&&(this.accounts=accounts),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountsUsersTab)),usersAccounts=this.$("#users-accounts-tab"),usersAccounts.html(template),this.tbody=this.$("#users-accounts-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderUsersAccountsRows()},renderUsersAccountsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.accounts.length,console.log("all users length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.accounts.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountRow))(data),rows.append(template);else this.noUsersAccounts()},noUsersAccounts:function(){"use strict";var template,noUsersAccounts;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noUsersAccounts=this.$("#no-users-accounts"),noUsersAccounts.html(template)},renderOrganizationsAccountsList:function(accounts){"use strict";var template,organizationsAccounts;console.log("render organizations accounts list"),accounts&&(this.accounts=accounts),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountsOrganizationsTab)),organizationsAccounts=this.$("#organizations-accounts-tab"),organizationsAccounts.html(template),this.tbody=this.$("#organizations-accounts-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderOrganizationsAccountsRows()},renderOrganizationsAccountsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.accounts.length,console.log("all organizations length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.accounts.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountRow))(data),rows.append(template);else this.noOrganizationsAccounts()},noOrganizationsAccounts:function(){"use strict";var template,noOrganizationsAccounts;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noOrganizationsAccounts=this.$("#no-organizations-accounts"),noOrganizationsAccounts.html(template)},renderDisableAccountsList:function(accounts){"use strict";var template,disableAccounts;console.log("render disable accounts list"),accounts&&(this.accounts=accounts),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountsDisableTab)),disableAccounts=this.$("#disable-accounts-tab"),disableAccounts.html(template),this.tbody=this.$("#disable-accounts-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderDisableAccountsRows()},renderDisableAccountsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.accounts.length,console.log("all disable length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.accounts.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountRow))(data),rows.append(template);else this.noDisableAccounts()},noDisableAccounts:function(){"use strict";var template,noDisableAccounts;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noDisableAccounts=this.$("#no-disable-accounts"),noDisableAccounts.html(template)},renderSuspendedAccountsList:function(accounts){"use strict";var template,suspendedAccounts;console.log("render suspended accounts list"),accounts&&(this.accounts=accounts),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountsSuspendedTab)),suspendedAccounts=this.$("#suspended-accounts-tab"),suspendedAccounts.html(template),this.tbody=this.$("#suspended-accounts-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderSuspendedAccountsRows()},renderSuspendedAccountsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.accounts.length,console.log("all suspended length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.accounts.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.accountRow))(data),rows.append(template);else this.noSuspendedAccounts()},noSuspendedAccounts:function(){"use strict";var template,noSuspendedAccounts;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noSuspendedAccounts=this.$("#no-suspended-accounts"),noSuspendedAccounts.html(template)},createAccount:function(event){"use strict";event.preventDefault(),console.log("create account")}}),fun.views.messages=Backbone.View.extend({events:{"click #create-message-btn":"createMessage"},initialize:function(options){fun.containers.messages=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.messages));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")},renderAllMessagesList:function(messages){"use strict";var template,allMessages;console.log("render all messages list"),messages&&(this.messages=messages),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesAllTab)),allMessages=this.$("#all-messages-tab"),allMessages.html(template),this.tbody=this.$("#all-messages-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderAllMessagesRows()},renderAllMessagesRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.messages.length,console.log("all messages length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.messages.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesRow))(data),rows.append(template);else this.noAllMessages()},noAllMessages:function(){"use strict";var template,noAllMessages;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noAllMessages=this.$("#no-all-messages"),noAllMessages.html(template)},renderUnreadMessagesList:function(messages){"use strict";var template,unreadMessages;console.log("render unread messages list"),messages&&(this.messages=messages),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesUnreadTab)),unreadMessages=this.$("#unread-messages-tab"),unreadMessages.html(template),this.tbody=this.$("#unread-messages-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderUnreadMessagesRows()},renderUnreadMessagesRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.messages.length,console.log("unread messages length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.messages.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesRow))(data),rows.append(template);else this.noUnreadMessages()},noUnreadMessages:function(){"use strict";var template,noUnreadMessages;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noUnreadMessages=this.$("#no-unread-messages"),noUnreadMessages.html(template)},renderNotificationsMessagesList:function(messages){"use strict";var template,notificationsMessages;console.log("render notifications messages list"),messages&&(this.messages=messages),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesNotificationsTab)),notificationsMessages=this.$("#notifications-messages-tab"),notificationsMessages.html(template),this.tbody=this.$("#notifications-messages-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderNotificationsMessagesRows()},renderNotificationsMessagesRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.messages.length,console.log("notifications messages length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.messages.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesRow))(data),rows.append(template);else this.noNotificationsMessages()},noNotificationsMessages:function(){"use strict";var template,noNotificationsMessages;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noNotificationsMessages=this.$("#no-notifications-messages"),noNotificationsMessages.html(template)},renderAlertsMessagesList:function(messages){"use strict";var template,alertsMessages;console.log("render alerts messages list"),messages&&(this.messages=messages),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesAlertsTab)),alertsMessages=this.$("#alerts-messages-tab"),alertsMessages.html(template),this.tbody=this.$("#alerts-messages-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderAlertsMessagesRows()},renderAlertsMessagesRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.messages.length,console.log("alerts messages length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.messages.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.messagesRow))(data),rows.append(template);else this.noAlertsMessages()},noAlertsMessages:function(){"use strict";var template,noAlertsMessages;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noAlertsMessages=this.$("#no-alerts-messages"),noAlertsMessages.html(template)},createMessage:function(event){"use strict";event.preventDefault(),console.log("create message")}}),fun.views.resources=Backbone.View.extend({events:{"click #create-resource-btn":"createResource","click .resource-popup":"resourceDetails","click #update-resource-btn":"updateResource","click #close-resource-btn":"closeResource","click input[name='resource_status']":"updateStatus"},initialize:function(options){fun.containers.resources=this.$el},render:function(){console.log("render tasts view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.resources));this.$el.html(template),this.$el.removeClass("hide").addClass("show"),"undefined"==typeof account&&(this.account=localStorage.getItem("username"))},renderAllResourcesList:function(resources){"use strict";var template,allResources;console.log("render resources list"),resources&&(this.resources=resources),template=_.template(fun.utils.getTemplate(fun.conf.templates.resourcesAllTab)),allResources=this.$("#all-resources-tab"),allResources.html(template),this.tbody=this.$("#all-resources-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderAllResourceRows()},renderAllResourceRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.resources.length,console.log("resources length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.resources.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.resourceRow))(data),rows.append(template);else this.noAllResources()},noAllResources:function(){"use strict";var template,noAllResources;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noAllResources=this.$("#no-all-resources"),noAllResources.html(template)},renderImpsResourcesList:function(resources){"use strict";var template,impsResources;console.log("render imps resources list"),resources&&(this.resources=resources),template=_.template(fun.utils.getTemplate(fun.conf.templates.resourcesImpsTab)),impsResources=this.$("#imps-resources-tab"),impsResources.html(template),this.tbody=this.$("#imps-resources-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderImpsResourceRows()},renderImpsResourceRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.resources.length,console.log("resources length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.resources.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.resourceRow))(data),rows.append(template);else this.noImpsResources()},noImpsResources:function(){"use strict";var template,noImpsResources;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noImpsResources=this.$("#no-imps-resources"),noImpsResources.html(template)},renderNodesResourcesList:function(resources){"use strict";var template,nodesResources;console.log("render nodes resources list"),resources&&(this.resources=resources),template=_.template(fun.utils.getTemplate(fun.conf.templates.resourcesNodesTab)),nodesResources=this.$("#nodes-resources-tab"),nodesResources.html(template),this.tbody=this.$("#nodes-resources-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderNodesResourceRows()},renderNodesResourceRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.resources.length,console.log("resources length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.resources.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.resourceRow))(data),rows.append(template);else this.noNodesResources()},noNodesResources:function(){"use strict";var template,noNodesResources;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noNodesResources=this.$("#no-nodes-resources"),noNodesResources.html(template)},createResource:function(event){"use strict";event.preventDefault();var account,resource,resourceName,resourceDescription,resourceLabel,resourcePayload,profile,first_name,last_name,user,view=this;console.log("create resource event"),this.resourceName=this.$("#resource_name"),this.resourceDescription=this.$("#resource_description"),this.resourceLabel="Service Requests",account=this.account,resourceName=this.resourceName.val(),resourceDescription=this.resourceDescription.val(),resourceLabel=this.resourceLabel,console.log(account,resourceName,resourceDescription,resourceLabel),resourcePayload={title:resourceName,description:resourceDescription,label:resourceLabel},profile=JSON.parse(localStorage.getItem("profile")),user=new fun.models.User(profile),user.fetch(),console.log(user.get("uuid")),console.log(user.get("first_name")),first_name="undefined"==typeof user.get("first_name")?"Mauricio":user.get("first_name"),last_name="undefined"==typeof user.get("last_name")?"Montero":user.get("last_name"),resourcePayload.first_name=first_name,resourcePayload.last_name=last_name,resourcePayload.email=user.get("email"),void 0===typeof account&&(account=!1,resourcePayload["public"]=account),void 0!=account&void 0!=resourceName&&(resourcePayload.account=account),resource=new fun.models.Resource(resourcePayload),resource.save(),view.$("#resource_name").val(""),view.$("#resource_description").val("")},resourceDetails:function(event){"use strict";event.preventDefault();var name,resource,resourceUuid,resourceTitle,resourceAssigned,resourceLabel,resourceSource,resourceStatus,resourcePriority,resourceSeverity,resourceDescription;resourceUuid=this.$("#resource-uuid"),resourceTitle=this.$("#resource-title"),resourceAssigned=this.$("#resource-assigned"),resourceLabel=this.$("#resource-label"),resourceSource=this.$("#resource-source"),resourceStatus=this.$("#resource-status"),resourcePriority=this.$("#resource-priority"),resourceSeverity=this.$("#resource-severity"),resourceDescription=this.$("#resource-description"),name=$(event.target).data("name"),resource=new fun.models.Resource({uuid:name}),resource.fetch({success:function(response){resourceUuid.html(response.get("uuid")),resourceTitle.html(response.get("title")||"Where's the title boy?"),resourceAssigned.html(response.get("assigned")),resourceLabel.html(response.get("label")),resourceSource.html(response.get("source")),resourceStatus.html(response.get("status")),resourcePriority.html(response.get("priority")),resourceSeverity.html(response.get("severity")),resourceDescription.html(response.get("description")),$("#resourceModal").modal({show:!0})},error:function(error){console.log(error)}})},updateStatus:function(event){"use strict";event.preventDefault();var idVal,label,callbacks;console.log("update status"),callbacks={success:function(){console.log("new account success")},error:function(model,error){console.log("wrong stuff on account create"),console.log(model,error)}},$('input[name="resource_status"]:checked').each(function(){idVal=$(this).attr("id"),label=$("label[for='"+idVal+"']").text(),console.log(label),this.status=label})},updateResource:function(event){"use strict";event.preventDefault();var update,status,comment,resourceUuid;this.status=$('input[name="resource_status"]:checked'),this.comment=this.$("#resource-comment"),this.uuid=this.$("#resource-uuid"),console.log("update resource"),resourceUuid=this.uuid.text(),status=this.status.val(),comment=this.comment.val(),update=new fun.models.Resource({uuid:resourceUuid});var newRandomStuff={status:status,comments:{comments:[{account:this.account,comment:comment}]}};update.save(newRandomStuff,{patch:!0})},closeResource:function(event){"use strict";event.preventDefault();console.log("close resource"),$("#resourceModal").modal("hide")}}),fun.views.contacts=Backbone.View.extend({events:{"change input[type=file]":"encodeFile","click #upload-csv-btn":"uploadCSV","click #get-dir-btn":"getDirectory","click #add-contact-btn":"addContact"},initialize:function(options){fun.containers.contacts=this.$el},render:function(){"use strict";var template;console.log("render contacts view"),this.$el.html()||(template=_.template(fun.utils.getTemplate(fun.conf.templates.contacts)),this.$el.html(template),this.contactFirstName=this.$("#contact_first_name"),this.contactLastName=this.$("#contact_last_name"),this.newPhoneNumber=this.$("#new-phone-number"),this.directoryName=this.$("#directory_name"),this.directoryDescription=this.$("#directory_description"),this.exampleInputFile=this.$("#exampleInputFile")),this.newPhoneNumber.intlTelInput({utilsScript:"static/js/plugins/libphonenumber/utils.js"}),this.$el.removeClass("hide").addClass("show")},renderContactLists:function(contacts){"use strict";var template,allContacts;console.log("render contact lists"),contacts&&(this.contacts=contacts),template=_.template(fun.utils.getTemplate(fun.conf.templates.allContacts)),allContacts=this.$("#all-contacts-tab"),allContacts.html(template),this.tbody=this.$("#contacts-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderContactRows()},renderContactRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.contacts.length,console.log(length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.contacts.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.contactRow))(data),rows.append(template);else this.noContacts()},noContacts:function(){"use strict";var template,noContacts;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noContacts=this.$("#no-contacts"),noContacts.html(template)},renderDirectoryLists:function(directories){"use strict";var template,directoryList;console.log("render directory lists"),directories&&(this.directories=directories),template=_.template(fun.utils.getTemplate(fun.conf.templates.directoryList)),directoryList=this.$("#directories-tab"),directoryList.html(template),this.dtbody=this.$("#directory-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderDirectoryRows()},renderDirectoryRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.directories.length,console.log(length),length>0)for(rows=this.dtbody.html(""),i;length>i;++i)data=_.extend(this.directories.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.directoryRow))(data),rows.append(template);else this.noDirectories()},noDirectories:function(){"use strict";var template,noDirectories;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noDirectories=this.$("#no-directories"),noDirectories.html(template)},encodeFile:function(event){"use strict";var file,reader;this.model=new fun.models.Upload,file=event.currentTarget.files[0],reader=new FileReader,reader.onload=function(fileEvent){this.model.set({filearg:fileEvent.target.result})}.bind(this),reader.onerror=function(){console.log("error",arguments)},reader.readAsDataURL(file)},uploadCSV:function(event){"use strict";event.preventDefault();var directoryName,directoryDescription,upload,view=this;upload=this.model,directoryName=this.directoryName.val(),directoryDescription=this.directoryDescription.val(),upload.set({directory_name:directoryName,
directory_description:directoryDescription}),upload.save(),view.$("#directory_name").val(""),view.$("#directory_description").val(""),view.$("#filearg").val("")},getDirectory:function(event){event.preventDefault(),console.log("getDirectory event")},addContact:function(event){"use strict";event.preventDefault();var firstName,lastName,newNumber,countryData,numberType,contact,view=this;console.log("new contact event"),firstName=this.contactFirstName.val(),lastName=this.contactLastName.val(),newNumber=this.newPhoneNumber.intlTelInput("getNumber"),countryData=this.newPhoneNumber.intlTelInput("getSelectedCountryData"),numberType=this.newPhoneNumber.intlTelInput("getNumberType"),contact=new fun.models.Contact({first_name:firstName,last_name:lastName,phone_number:newNumber,number_type:numberType}),contact.save(),view.$("#contact_first_name").val(""),view.$("#contact_last_name").val(""),view.$("#new-phone-number").val("")}}),fun.views.cubes=Backbone.View.extend({events:{"click #create-cube-btn":"createCube"},initialize:function(options){fun.containers.cubes=this.$el},render:function(){if(!this.$el.html()){var template=_.template(fun.utils.getTemplate(fun.conf.templates.cubes));this.$el.html(template)}this.$el.removeClass("hide").addClass("show")},createCube:function(event){"use strict";event.preventDefault(),console.log("create cube")}}),fun.views.tasks=Backbone.View.extend({events:{"click #create-task-btn":"createTask","click .task-popup":"taskDetails","click #update-task-btn":"updateTask","click #close-task-btn":"closeTask","click input[name='task_status']":"updateStatus"},initialize:function(options){fun.containers.tasks=this.$el,this.status="gut?"},render:function(){console.log("render tasts view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.tasks));this.$el.html(template),this.$el.removeClass("hide").addClass("show"),"undefined"==typeof account&&(this.account=localStorage.getItem("username"))},renderTasksList:function(tasks){"use strict";var template,allTasks;console.log("render tasks list"),tasks&&(this.tasks=tasks),template=_.template(fun.utils.getTemplate(fun.conf.templates.allTasks)),allTasks=this.$("#all-tasks-tab"),allTasks.html(template),this.tbody=this.$("#tasks-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderTaskRows()},renderTaskRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.tasks.length,console.log("tasks length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.tasks.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.taskRow))(data),rows.append(template);else this.noTasks()},noTasks:function(){"use strict";var template,noTasks;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noTasks=this.$("#no-tasks"),noTasks.html(template)},renderNowTasksList:function(tasks){"use strict";var template,nowTasks;console.log("render now tasks list"),tasks&&(this.tasks=tasks),template=_.template(fun.utils.getTemplate(fun.conf.templates.tasksNowTab)),nowTasks=this.$("#now-tasks-tab"),nowTasks.html(template),this.tbody=this.$("#now-tasks-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderNowTaskRows()},renderNowTaskRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.tasks.length,console.log("now tasks length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.tasks.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.taskRow))(data),rows.append(template);else this.noNowTasks()},noNowTasks:function(){"use strict";var template,noNowTasks;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noNowTasks=this.$("#no-now-tasks"),noNowTasks.html(template)},renderLaterTasksList:function(tasks){"use strict";var template,laterTasks;console.log("render now tasks list"),tasks&&(this.tasks=tasks),template=_.template(fun.utils.getTemplate(fun.conf.templates.tasksLaterTab)),laterTasks=this.$("#later-tasks-tab"),laterTasks.html(template),this.tbody=this.$("#later-tasks-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderLaterTaskRows()},renderLaterTaskRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.tasks.length,console.log("later tasks length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.tasks.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.taskRow))(data),rows.append(template);else this.noLaterTasks()},noLaterTasks:function(){"use strict";var template,noLaterTasks;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noLaterTasks=this.$("#no-later-tasks"),noLaterTasks.html(template)},renderDoneTasksList:function(tasks){"use strict";var template,doneTasks;console.log("render done tasks list"),tasks&&(this.tasks=tasks),template=_.template(fun.utils.getTemplate(fun.conf.templates.tasksDoneTab)),doneTasks=this.$("#done-tasks-tab"),doneTasks.html(template),this.tbody=this.$("#now-done-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderDoneTaskRows()},renderDoneTaskRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.tasks.length,console.log("done tasks length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.tasks.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.taskRow))(data),rows.append(template);else this.noDoneTasks()},noDoneTasks:function(){"use strict";var template,noDoneTasks;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noDoneTasks=this.$("#no-done-tasks"),noDoneTasks.html(template)},createTask:function(event){"use strict";event.preventDefault();var account,task,taskName,taskDescription,taskLabel,taskPayload,profile,first_name,last_name,user,view=this;console.log("create task event"),this.taskName=this.$("#task_name"),this.taskDescription=this.$("#task_description"),this.taskLabel="Service Requests",account=this.account,taskName=this.taskName.val(),taskDescription=this.taskDescription.val(),taskLabel=this.taskLabel,console.log(account,taskName,taskDescription,taskLabel),taskPayload={title:taskName,description:taskDescription,label:taskLabel},profile=JSON.parse(localStorage.getItem("profile")),user=new fun.models.User(profile),user.fetch(),console.log(user.get("uuid")),console.log(user.get("first_name")),first_name="undefined"==typeof user.get("first_name")?"Mauricio":user.get("first_name"),last_name="undefined"==typeof user.get("last_name")?"Montero":user.get("last_name"),taskPayload.first_name=first_name,taskPayload.last_name=last_name,taskPayload.email=user.get("email"),void 0===typeof account&&(account=!1,taskPayload["public"]=account),void 0!=account&void 0!=taskName&&(taskPayload.account=account),task=new fun.models.Task(taskPayload),task.save(),view.$("#task_name").val(""),view.$("#task_description").val("")},taskDetails:function(event){"use strict";event.preventDefault();var task,name,taskUuid,taskTitle,taskAssigned,taskLabel,taskSource,taskStatus,taskPriority,taskSeverity,taskDescription;taskUuid=this.$("#task-uuid"),taskTitle=this.$("#task-title"),taskAssigned=this.$("#task-assigned"),taskLabel=this.$("#task-label"),taskSource=this.$("#task-source"),taskStatus=this.$("#task-status"),taskPriority=this.$("#task-priority"),taskSeverity=this.$("#task-severity"),taskDescription=this.$("#task-description"),name=$(event.target).data("name"),task=new fun.models.Task({uuid:name}),task.fetch({success:function(response){taskUuid.html(response.get("uuid")),taskTitle.html(response.get("title")||"Where's the title boy?"),taskAssigned.html(response.get("assigned")),taskLabel.html(response.get("label")),taskSource.html(response.get("source")),taskStatus.html(response.get("status")),taskPriority.html(response.get("priority")),taskSeverity.html(response.get("severity")),taskDescription.html(response.get("description")),$("#taskModal").modal({show:!0})},error:function(error){console.log(error)}})},updateStatus:function(event){"use strict";event.preventDefault();var idVal,label,callbacks;console.log("update status"),callbacks={success:function(){console.log("new account success")},error:function(model,error){console.log("wrong stuff on account create"),console.log(model,error)}},$('input[name="task_status"]:checked').each(function(){idVal=$(this).attr("id"),label=$("label[for='"+idVal+"']").text(),console.log(label),this.status=label})},updateTask:function(event){"use strict";event.preventDefault();var update,status,comment,taskUuid;this.status=$('input[name="task_status"]:checked'),this.comment=this.$("#task-comment"),this.uuid=this.$("#task-uuid"),console.log("update task"),taskUuid=this.uuid.text(),status=this.status.val(),comment=this.comment.val(),update=new fun.models.Task({uuid:taskUuid});var newRandomStuff={status:status,comments:{comments:[{account:this.account,comment:comment}]}};update.save(newRandomStuff,{patch:!0})},closeTask:function(event){"use strict";event.preventDefault();console.log("close task"),$("#taskModal").modal("hide")}}),fun.views.companies=Backbone.View.extend({events:{"click #create-company-btn":"createCompany","click .company-popup":"companyDetails","click #update-btn":"updateCompany","click #close-btn":"closePopup","click input[name='company_status']":"updateStatus"},initialize:function(options){fun.containers.companies=this.$el},render:function(){console.log("render tasts view");var template;this.$el.html()||(template=_.template(fun.utils.getTemplate(fun.conf.templates.companies)),this.$el.html(template),this.account=this.$("#reg_signup_username"),this.password=this.$("#reg_signup_password"),this.email=this.$("#reg_signup_email"),this.companyName=this.$("#reg_company_name"),this.streetAddress=this.$("#reg_street_address"),this.cityTown=this.$("#reg_city_town"),this.stateProvince=this.$("#reg_state_province"),this.zipPostal=this.$("#reg_zip_postal"),this.countryCompany=this.$("#reg_country_company"),this.dba=this.$("#reg_dba"),this.telephone=this.$("#reg_telephone"),this.fax=this.$("#reg_fax"),this.companyEmail=this.$("#reg_company_email"),this.incorporatedNumber=this.$("#reg_incorporated_number"),this.legalCompanyName=this.$("#reg_legal_company_name"),this.dateOfIncorporation=this.$("#reg_date_incorporation"),this.incorporatedAddress=this.$("#reg_incorporated_address"),this.incorporatedStateProvince=this.$("#reg_incorporated_state"),this.incorporatedCountry=this.$("#reg_incorporated_country"),this.federalTaxId=this.$("#reg_federal_tax_id"),this.vatTaxIdFileNumber=this.$("#reg_vat_tax_id"),this.ifCompanySubsidiaryName=this.$("#reg_subsidiary_name"),this.ifCompanySubsidiaryRegistrationNum=this.$("#reg_subsidiary_reg_num")),this.$el.removeClass("hide").addClass("show")},renderCompaniesList:function(companies){"use strict";var template,allCompanies;console.log("render companies list"),companies&&(this.companies=companies),template=_.template(fun.utils.getTemplate(fun.conf.templates.allCompanies)),allCompanies=this.$("#all-companies-tab"),allCompanies.html(template),this.tbody=this.$("#companies-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderCompanyRows()},renderCompanyRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.companies.length,console.log("companies length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.companies.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.companyRow))(data),rows.append(template);else this.noCompanies()},noCompanies:function(){"use strict";var template,noCompanies;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noCompanies=this.$("#no-companies"),noCompanies.html(template)},renderActiveCompaniesList:function(companies){"use strict";var template,activeCompanies;console.log("render active companies list"),companies&&(this.companies=companies),template=_.template(fun.utils.getTemplate(fun.conf.templates.companiesActiveTab)),activeCompanies=this.$("#active-companies-tab"),activeCompanies.html(template),this.tbody=this.$("#active-companies-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderActiveCompanyRows()},renderActiveCompanyRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.companies.length,console.log("active companies length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.companies.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.companyRow))(data),rows.append(template);else this.noActiveCompanies()},noActiveCompanies:function(){"use strict";var template,noActiveCompanies;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noActiveCompanies=this.$("#no-active-companies"),noActiveCompanies.html(template)},renderDisableCompaniesList:function(companies){"use strict";var template,disableCompanies;console.log("render disable companies list"),companies&&(this.companies=companies),template=_.template(fun.utils.getTemplate(fun.conf.templates.companiesDisableTab)),disableCompanies=this.$("#disable-companies-tab"),disableCompanies.html(template),this.tbody=this.$("#disable-companies-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderDisableCompanyRows()},renderDisableCompanyRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.companies.length,console.log("disable companies length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.companies.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.companyRow))(data),rows.append(template);else this.noDisableCompanies()},noDisableCompanies:function(){"use strict";var template,noDisableCompanies;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noDisableCompanies=this.$("#no-disable-companies"),noDisableCompanies.html(template)},createCompany:function(event){"use strict";event.preventDefault();var account,companyName,companyDescription,companyLabel,view=this;console.log("create company event"),this.companyName=this.$("#company_name"),this.companyDescription=this.$("#company_description"),this.companyLabel="Service Requests",account=this.account,companyName=this.companyName.val(),companyDescription=this.companyDescription.val(),companyLabel=this.companyLabel,$("#newCompanyModal").modal({show:!0}),view.$("#company_name").val(""),view.$("#company_description").val("")},companyDetails:function(event){"use strict";event.preventDefault();var account,password,email,company,name,companyUuid,companyName,streetAddress,cityTown,stateProvince,zipPostal,countryCompany,dba,telephone,fax,companyEmail,incorporatedNumber,legalCompanyName,dateOfIncorporation,incorporatedStateProvince,incorporatedAddress,incorporatedNumber,incorporatedCountry,federalTaxId,vatTaxIdFileNumber,ifCompanySubsidiaryName,ifCompanySubsidiaryRegistrationNum;account=this.account,password=this.password,email=this.email,companyUuid=this.$("#company-uuid"),companyName=this.companyName,streetAddress=this.streetAddress,cityTown=this.cityTown,stateProvince=this.stateProvince,zipPostal=this.zipPostal,countryCompany=this.countryCompany,dba=this.dba,telephone=this.telephone,fax=this.fax,companyEmail=this.companyEmail,incorporatedNumber=this.incorporatedNumber,legalCompanyName=this.legalCompanyName,dateOfIncorporation=this.dateOfIncorporation,incorporatedStateProvince=this.incorporatedStateProvince,incorporatedAddress=this.incorporatedAddress,incorporatedNumber=this.incorporatedNumber,incorporatedCountry=this.incorporatedCountry,federalTaxId=this.federalTaxId,vatTaxIdFileNumber=this.vatTaxIdFileNumber,ifCompanySubsidiaryName=this.ifCompanySubsidiaryName,ifCompanySubsidiaryRegistrationNum=this.ifCompanySubsidiaryRegistrationNum,name=$(event.target).data("name"),company=new fun.models.Company({uuid:name}),company.fetch({success:function(response){companyUuid.html(response.get("uuid")),account.html(response.get("account")),password.html(response.get("password")),email.html(response.get("email")),companyName.html(response.get("company_name")),streetAddress.html(response.get("street_address")),cityTown.html(response.get("city_town")),stateProvince.html(response.get("state_province")),zipPostal.html(response.get("zip_postal")),countryCompany.html(response.get("country_company")),dba.html(response.get("dba")),telephone.html(response.get("telephone")),fax.html(response.get("fax")),companyEmail.html(response.get("company_email")),incorporatedNumber.html(response.get("incorporated_number")),legalCompanyName.html(response.get("reg_legal_company_name")),incorporatedStateProvince.html(response.get("incorporated_state_province")),incorporatedAddress.html(response.get("incorporated_address")),incorporatedNumber.html(response.get("incorporated_number")),incorporatedCountry.html(response.get("incoportated_country")),federalTaxId.html(response.get("federal_tax_id")),vatTaxIdFileNumber.html(response.get("vat_tax_id_file_number")),ifCompanySubsidiaryName.html(response.get("subsidiary_name")),ifCompanySubsidiaryRegistrationNum.html(response.get("subsidiary_reg_num"));var tempAccount={account:response.get("account"),password:response.get("password"),email:response.get("email")};localStorage.setItem("tempAccount",JSON.stringify(tempAccount)),$("#companyModal").modal({show:!0})},error:function(model,status,error){console.log(error,status,model),console.log("error getting company uuid:"+name)}})},updateCompany:function(event){"use strict";event.preventDefault();console.log("update company"),$("#companyModal").modal("hide")},closePopup:function(event){"use strict";event.preventDefault();console.log("close company details popup"),$("#companyModal").modal("hide")},updateStatus:function(event){"use strict";var idVal,label,status,callbacks,uuid=this.$("#company-uuid"),stuff=JSON.parse(localStorage.getItem("tempAccount"));console.log("update status");var account_uuid=uuid.html(),account_name=stuff.account;callbacks={success:function(){console.log("new account success")},error:function(model,error){console.log("wrong stuff on account create")}},$('input[name="company_status"]:checked').each(function(){if(idVal=$(this).attr("id"),label=$("label[for='"+idVal+"']").text(),status={status:label},"active"===label&&(this.model=new fun.models.Account,this.model.save({account:stuff.account,password:stuff.password,email:stuff.email},callbacks),this.alert=new fun.models.Alert,this.alert.save({account:stuff.account,name:"Jean Chassoul",email:"chassoul@gmail.com",body:JSON.stringify(stuff)})),"disable"===label){var update=new fun.models.User({uuid:account_uuid,account:account_name}),buenaNota={status:label};update.save(buenaNota,{patch:!0})}if("suspended"===label){var update=new fun.models.User({uuid:account_uuid,account:account_name}),buenaNota={status:label};update.save(buenaNota,{patch:!0})}})}}),fun.views.sounds=Backbone.View.extend({events:{},initialize:function(options){fun.containers.sounds=this.$el},render:function(){console.log("render sounds view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.sounds));this.$el.html(template),this.$el.removeClass("hide").addClass("show")}}),fun.views.recordings=Backbone.View.extend({events:{},initialize:function(options){fun.containers.recordings=this.$el},render:function(){console.log("render recordings view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.recordings));this.$el.html(template),this.$el.removeClass("hide").addClass("show")},renderAllRecordingsList:function(recordings){"use strict";var template,allRecordings;console.log("render all recordings list"),recordings&&(this.recordings=recordings),template=_.template(fun.utils.getTemplate(fun.conf.templates.recordingsAllTab)),allRecordings=this.$("#all-recordings-tab"),allRecordings.html(template),this.tbody=this.$("#all-recordings-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderAllRecordingsRows()},renderAllRecordingsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.recordings.length,console.log("all recordings length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.recordings.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.recordingRow))(data),rows.append(template);else this.noAllRecordings()},noAllRecordings:function(){"use strict";var template,noAllRecordings;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noAllRecordings=this.$("#no-all-recordings"),noAllRecordings.html(template)},renderInboundRecordingsList:function(recordings){"use strict";var template,inboundRecordings;console.log("render inbound recordings list"),recordings&&(this.recordings=recordings),template=_.template(fun.utils.getTemplate(fun.conf.templates.recordingsInboundTab)),inboundRecordings=this.$("#inbound-recordings-tab"),inboundRecordings.html(template),this.tbody=this.$("#inbound-recordings-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderInboundRecordingsRows()},renderInboundRecordingsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.recordings.length,console.log("inbound recordings length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.recordings.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.recordingRow))(data),rows.append(template);else this.noInboundRecordings()},noInboundRecordings:function(){"use strict";var template,noInboundRecordings;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noInboundRecordings=this.$("#no-inbound-recordings"),noInboundRecordings.html(template)},renderOutboundRecordingsList:function(recordings){"use strict";var template,outboundRecordings;console.log("render outbound recordings list"),recordings&&(this.recordings=recordings),template=_.template(fun.utils.getTemplate(fun.conf.templates.recordingsOutboundTab)),outboundRecordings=this.$("#outbound-recordings-tab"),outboundRecordings.html(template),this.tbody=this.$("#outbound-recordings-list > tbody"),this.$el.removeClass("hide").addClass("show"),this.renderOutboundRecordingsRows()},renderOutboundRecordingsRows:function(){"use strict";var length,rows,data,template,i=0;if(length=this.recordings.length,console.log("outbound recordings length: ",length),length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.recordings.at(i).toJSON(),{i:i}),template=_.template(fun.utils.getTemplate(fun.conf.templates.recordingRow))(data),rows.append(template);else this.noOutboundRecordings()},noOutboundRecordings:function(){"use strict";var template,noOutboundRecordings;template=_.template(fun.utils.getTemplate(fun.conf.templates.warning))({message:"noDataAvailable"}),noOutboundRecordings=this.$("#no-outbound-recordings"),noOutboundRecordings.html(template)}}),fun.views.reports=Backbone.View.extend({events:{"click #fun-btn-find":"findReport","click #fun-btn-hours":"hours","click #details-report-btn":"detailsReport","click #fun-btn-days":"days","click #fun-btn-weeks":"weeks","click #fun-btn-months":"months","click #fun-btn-years":"years"},initialize:function(options){fun.containers.reports=this.$el},render:function(){"use strict";console.log("render reports view");var template=_.template(fun.utils.getTemplate(fun.conf.templates.reports));this.$el.html(template),this.$el.removeClass("hide").addClass("show"),this.renderControl()},renderControl:function(){"use strict";var templateFrom,templateTo,templateFindLapse;templateFrom=_.template(fun.utils.getTemplate(fun.conf.templates.controlFrom)),templateTo=_.template(fun.utils.getTemplate(fun.conf.templates.controlTo)),templateFindLapse=_.template(fun.utils.getTemplate(fun.conf.templates.findLapse)),this.controlFrom=this.$("#fun-control-from"),this.controlTo=this.$("#fun-control-to"),this.findLapse=this.$("#fun-find-lapse"),this.controlFrom.html(templateFrom),this.controlTo.html(templateTo),this.findLapse.html(templateFindLapse),this.fromDate=this.$("#from-date"),this.toDate=this.$("#to-date"),this.$("#from-date").datepicker({format:"yyyy-mm-dd"}),this.$("#to-date").datepicker({format:"yyyy-mm-dd"})},findReport:function(event){"use strict";event.preventDefault();var fromDate,toDate,startEnd,startEndLapse,models,success,modelCount=0;fromDate=this.fromDate.data("datepicker").getDate(),toDate=this.toDate.data("datepicker").getDate(),this.start=Math.round(fromDate.getTime()/1e3),this.end=Math.round(toDate.getTime()/1e3),startEnd={start:this.start,end:this.end},startEndLapse={start:this.start,end:this.end,lapse:this.lapse},models={records:new fun.models.RecordsStartEnd(startEnd),summary:new fun.models.SummaryStartEnd(startEnd),summaries:new fun.models.SummariesStartEnd(startEnd),billing:new fun.models.BillingStartEnd(startEnd)},success=function(){++modelCount===_.keys(models).length&&(fun.instances.reports.renderRecordsDetails(models.records),fun.instances.reports.renderRecordsSummary(models.summary,models.billing))};for(var x in models)models[x].fetch({success:success,error:function(){console.log("error")}})},hours:function(event){console.log("hours")},days:function(event){console.log("days")},weeks:function(event){console.log("weeks")},months:function(event){console.log("months")},years:function(event){console.log("years")},renderDetailsRows:function(){"use strict";var rows,data,recordRow,i=0,length=this.collection.length;if(length>0)for(rows=this.tbody.html(""),i;length>i;++i)data=_.extend(this.collection.at(i).toJSON(),{i:i}),recordRow=_.template(fun.utils.getTemplate(fun.conf.templates.recordRow))(data),rows.append(recordRow);else this.noCalls()},noCalls:function(){var htmlId=this.$("#no-records");htmlId.html(_.template(fun.utils.getTemplate(fun.conf.templates.warning))({msg:"noDataAvailable"}))},renderSummariesRows:function(){},renderRecordsDetails:function(collection){collection?this.collection=collection:this.collection=0,this.tbody=this.$("#cdr-list > tbody"),this.renderDetailsRows()},renderRecordsSummary:function(summary,billing){if(summary&&billing){this.summary=summary,this.billing=billing;var data=_.extend(this.summary.toJSON(),this.billing.toJSON())}else var data={minutes:0,records:0,record_avg:0,billing:0};this.data=data,this.stuffSummary=this.$("#summary-list > tbody"),this.renderSummaryRows()},detailsReport:function(){console.log("navbar detail reports")}}),fun.views.settings=Backbone.View.extend({events:{"click #user-update-btn":"updateUserAccount","click #user-delete-btn":"deleteUserAccount"},initialize:function(options){fun.containers.settings=this.$el},render:function(account){"use strict";var template,accountProfile=JSON.parse(localStorage.getItem("profile"));console.log("render settings view"),this.accountProfile=accountProfile,null===account&&(account="username"),template=_.template(fun.utils.getTemplate(fun.conf.templates.settings))({account:account}),this.$el.html(template),this.email=this.$("#user_email"),this.firstName=this.$("#user_first_name"),this.lastName=this.$("#user_last_name"),this.location=this.$("#user_location"),this.company=this.$("#user_company"),this.url=this.$("#user_url"),this.firstName.val(this.accountProfile.first_name||""),this.lastName.val(this.accountProfile.last_name||""),this.location.val(this.accountProfile.location||""),this.company.val(this.accountProfile.company||""),this.url.val(this.accountProfile.url||""),this.email.val(this.accountProfile.email||""),this.$el.removeClass("hide").addClass("show")},setProfileInformation:function(model){console.log("setting profile information"),localStorage.setItem("profile",JSON.stringify(model.toJSON()))},updateUserAccount:function(event){"use strict";event.preventDefault(),console.log("like a ninja");var email,first_name,last_name,location,company,url,confirm=new fun.models.User({account:this.accountProfile.account});email=this.email.val(),first_name=this.firstName.val(),last_name=this.lastName.val(),location=this.location.val(),company=this.company.val(),url=this.url.val();var newRandomStuff={first_name:first_name,last_name:last_name,email:email,company:company,location:location,url:url};console.log(newRandomStuff),confirm.save(newRandomStuff,{patch:!0})},deleteUserAccount:function(event){"use strict";event.preventDefault(),console.log("delete account");var confirm=new fun.models.User({account:this.accountProfile.account});confirm.destroy()}}),fun.views.extra=Backbone.View.extend({events:{"click #subscribe-btn":"subscribe"},initialize:function(options){fun.containers.extra=this.$el},render:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.extra));this.$el.html(template),this.$el.removeClass("hide").addClass("show"),fun.utils.loggedIn()?this.renderNavDashboard():this.renderNavLanding()},renderNavLanding:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.extraNavLanding)),navLanding=this.$("#fun-extra-nav-landing");navLanding.html(template),this.renderSocial(),this.renderSubscribe()},renderNavDashboard:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.extraNavDashboard)),navDashboard=this.$("#fun-extra-nav-dashboard");navDashboard.html(template)},renderSocial:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.social)),social=this.$("#fun-extra-social");social.html(template)},renderSubscribe:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.subscribe)),subscribe=this.$("#fun-extra-subscribe");subscribe.html(template)},subscribe:function(event){event.preventDefault();var email=this.$("#subscribe-email").val();fun.utils.subscribe(email,{success:function(jqXHR,textStatus){this.$("#subscribe-email").val("")},error:function(jqXHR,textStatus,errorThrown){console.log("subscribe error")}})}}),fun.views.footer=Backbone.View.extend({events:{},initialize:function(options){fun.containers.footer=this.$el},render:function(){var template=_.template(fun.utils.getTemplate(fun.conf.templates.footer));this.$el.html(template),this.$el.removeClass("hide").addClass("show")}});